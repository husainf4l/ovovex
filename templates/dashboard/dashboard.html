{% extends 'base.html' %}
{% load static %}
{% block content %}
{% include 'components/sidemenu.html' %}

<div
  class="min-h-screen bg-gray-50 dark:bg-gray-900 ml-64 transition-colors duration-300"
>
  <!-- Top Navigation Bar -->
  <div
    class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 transition-colors duration-300"
  >
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">
          Accounting Dashboard
        </h1>
        <span
          class="px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-sm font-medium rounded-full"
          >Live Data</span
        >
      </div>
      <div class="flex items-center space-x-4">
        <!-- Quick Search -->
        <div class="relative">
          <input
            type="text"
            placeholder="Search transactions, invoices..."
            class="w-64 pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
          />
          <i
            class="fas fa-search absolute left-3 top-3 text-gray-400 dark:text-gray-500"
          ></i>
        </div>
        <!-- Notifications -->
        <div class="relative">
          <button
            id="notifications-btn"
            class="relative p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
          >
            <i class="fas fa-bell text-xl"></i>
            <span
              id="notification-count"
              class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 items-center justify-center hidden"
              >0</span
            >
          </button>
          <!-- Notifications Dropdown -->
          <div
            id="notifications-dropdown"
            class="absolute top-full right-0 mt-2 w-96 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 max-h-96 overflow-hidden"
          >
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
              <div class="flex items-center justify-between">
                <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
                  Notifications
                </h3>
                <div class="flex items-center space-x-2">
                  <button
                    id="mark-all-read-btn"
                    class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300"
                  >
                    Mark all read
                  </button>
                  <button
                    id="refresh-notifications-btn"
                    class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
                  >
                    <i class="fas fa-sync-alt text-sm"></i>
                  </button>
                </div>
              </div>
            </div>
            <div id="notifications-list" class="max-h-80 overflow-y-auto">
              <!-- Notifications will be loaded here -->
              <div class="p-4 text-center text-gray-500 dark:text-gray-400">
                <i class="fas fa-bell-slash text-3xl mb-2"></i>
                <p>Loading notifications...</p>
              </div>
            </div>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
              <a
                href="#"
                class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium"
                >View All Notifications</a
              >
            </div>
          </div>
        </div>
        <!-- Company Selector -->
        <select
          class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
        >
          <option>Ovovex Corp</option>
          <option>Subsidiary A</option>
          <option>Subsidiary B</option>
        </select>
        <!-- Theme Toggle -->
        <button
          id="theme-toggle"
          class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-300"
        >
          <i class="fas fa-moon text-xl dark:hidden"></i>
          <i class="fas fa-sun text-xl hidden dark:inline"></i>
        </button>
        <!-- Help & Support -->
        <div class="relative">
          <button
            id="help-btn"
            class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-300"
            title="Help & Support"
          >
            <i class="fas fa-question-circle text-xl"></i>
          </button>
          <!-- Help Dropdown -->
          <div
            id="help-dropdown"
            class="absolute top-full right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50"
          >
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
                Help & Support
              </h3>
              <p class="text-sm text-gray-600 dark:text-gray-400">
                Get help with Ovovex
              </p>
            </div>
            <div class="p-4 space-y-3">
              <a
                href="#"
                class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
              >
                <div
                  class="w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center"
                >
                  <i class="fas fa-book text-blue-600 dark:text-blue-400"></i>
                </div>
                <div>
                  <div class="font-medium text-gray-900 dark:text-gray-100">
                    Documentation
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    User guides & tutorials
                  </div>
                </div>
              </a>
              <a
                href="#"
                class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
              >
                <div
                  class="w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center"
                >
                  <i
                    class="fas fa-robot text-green-600 dark:text-green-400"
                  ></i>
                </div>
                <div>
                  <div class="font-medium text-gray-900 dark:text-gray-100">
                    AI Assistant
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Get instant answers
                  </div>
                </div>
              </a>
              <a
                href="#"
                class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
              >
                <div
                  class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center"
                >
                  <i
                    class="fas fa-video text-purple-600 dark:text-purple-400"
                  ></i>
                </div>
                <div>
                  <div class="font-medium text-gray-900 dark:text-gray-100">
                    Video Tutorials
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Step-by-step guides
                  </div>
                </div>
              </a>
              <a
                href="#"
                class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
              >
                <div
                  class="w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center"
                >
                  <i
                    class="fas fa-comments text-orange-600 dark:text-orange-400"
                  ></i>
                </div>
                <div>
                  <div class="font-medium text-gray-900 dark:text-gray-100">
                    Community Forum
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Connect with other users
                  </div>
                </div>
              </a>
              <a
                href="#"
                class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
              >
                <div
                  class="w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center"
                >
                  <i class="fas fa-headset text-red-600 dark:text-red-400"></i>
                </div>
                <div>
                  <div class="font-medium text-gray-900 dark:text-gray-100">
                    Contact Support
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Get help from our team
                  </div>
                </div>
              </a>
            </div>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
              <div class="text-center">
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">
                  Need immediate help?
                </p>
                <button
                  class="w-full bg-blue-600 text-white text-sm font-medium py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200"
                >
                  Start Live Chat
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-6 pb-8">
    <!-- Welcome Header with AI Insights -->
    <div
      class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-lg p-8 mb-8 text-white"
    >
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between">
        <div class="mb-6 lg:mb-0">
          <h1 class="text-3xl font-bold mb-2">Welcome back, {{ user.first_name|default:user.username }}!</h1>
          <p class="text-lg opacity-90 mb-4">
            Your financial health looks strong this month
          </p>
          <div class="flex items-center space-x-4 text-sm">
            <span class="bg-white/20 px-3 py-1 rounded-full"
              >AI Insight: Revenue up 12.5%</span
            >
            <span class="bg-white/20 px-3 py-1 rounded-full"
              >Cash flow positive</span
            >
            <span class="bg-white/20 px-3 py-1 rounded-full"
              >3 invoices due soon</span
            >
          </div>
        </div>
        <div class="flex flex-col sm:flex-row gap-4">
          <div class="relative">
            <button
              class="inline-flex items-center justify-center px-6 py-3 bg-white text-blue-600 font-semibold rounded-xl hover:bg-gray-50 transition-colors duration-200 dropdown-toggle"
              id="quick-action-btn"
            >
              <i class="fas fa-plus mr-2"></i>
              Quick Action
              <i class="fas fa-chevron-down ml-2"></i>
            </button>
            <div
              class="absolute top-full mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50"
              id="quick-action-menu"
            >
              <div class="py-2">
                <!-- Accounting Tasks -->
                <div
                  class="px-4 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Accounting
                </div>
                <a
                  href="{% url 'create_invoice' %}"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-file-invoice-dollar mr-2"></i>
                  Create Invoice
                </a>
                <a
                  href="{% url 'expense_management' %}"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-receipt mr-2"></i>
                  Add Expense
                </a>
                <a
                  href="{% url 'create_journal_entry' %}"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-journal-whills mr-2"></i>
                  New Journal Entry
                </a>
                <a
                  href="{% url 'bank_reconciliation' %}"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-university mr-2"></i>
                  Reconcile Bank
                </a>
                <div
                  class="border-t border-gray-200 dark:border-gray-600 my-2"
                ></div>

                <!-- Approval Tasks -->
                <div
                  class="px-4 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Approvals
                </div>
                <a
                  href="#"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-check-circle mr-2 text-orange-500"></i>
                  Pending Approvals
                  <span
                    class="ml-auto bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 text-xs px-2 py-1 rounded-full"
                    >3</span
                  >
                </a>
                <a
                  href="#"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-clock mr-2 text-blue-500"></i>
                  Expense Reviews
                  <span
                    class="ml-auto bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs px-2 py-1 rounded-full"
                    >7</span
                  >
                </a>
                <a
                  href="#"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-file-signature mr-2 text-purple-500"></i>
                  Invoice Approvals
                  <span
                    class="ml-auto bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 text-xs px-2 py-1 rounded-full"
                    >2</span
                  >
                </a>
                <div
                  class="border-t border-gray-200 dark:border-gray-600 my-2"
                ></div>

                <!-- Reports & Analytics -->
                <div
                  class="px-4 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Reports
                </div>
                <a
                  href="{% url 'financial_statements' %}"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-chart-bar mr-2"></i>
                  Generate Report
                </a>
                <a
                  href="#"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-calendar-alt mr-2"></i>
                  Monthly Summary
                </a>
                <a
                  href="#"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  <i class="fas fa-download mr-2"></i>
                  Export Data
                </a>
              </div>
            </div>
          </div>
          <button
            class="inline-flex items-center justify-center px-6 py-3 bg-white/20 text-white font-semibold rounded-xl hover:bg-white/30 transition-colors duration-200"
          >
            <i class="fas fa-robot mr-2"></i>
            <a
              href="{% url 'ai_insights' %}"
              class="text-white hover:text-gray-200"
              >AI Assistant</a
            >
          </button>
        </div>
      </div>
    </div>

    <!-- KPI Cards Row -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8">
      <!-- Total Revenue -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-dollar-sign text-green-600 dark:text-green-400 text-xl"
            ></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >+12.5%</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $247,580
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">
          Total Revenue
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          vs last month
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-green-600 h-1 rounded-full" style="width: 85%"></div>
        </div>
      </div>

      <!-- Total Expenses -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-red-100 dark:bg-red-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-shopping-cart text-red-600 dark:text-red-400 text-xl"
            ></i>
          </div>
          <span class="text-red-600 dark:text-red-400 text-sm font-medium"
            >-3.2%</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $89,420
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">
          Total Expenses
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          vs last month
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-red-600 h-1 rounded-full" style="width: 65%"></div>
        </div>
      </div>

      <!-- Net Profit -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-chart-line text-blue-600 dark:text-blue-400 text-xl"
            ></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >+18.7%</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $158,160
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Net Profit</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          vs last month
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-blue-600 h-1 rounded-full" style="width: 92%"></div>
        </div>
      </div>

      <!-- Cash on Hand -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-yellow-100 dark:bg-yellow-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-wallet text-yellow-600 dark:text-yellow-400 text-xl"
            ></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >+5.1%</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $423,750
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Cash on Hand</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Available balance
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-yellow-600 h-1 rounded-full" style="width: 78%"></div>
        </div>
      </div>

      <!-- Outstanding Invoices -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-file-invoice text-purple-600 dark:text-purple-400 text-xl"
            ></i>
          </div>
          <span class="text-orange-600 dark:text-orange-400 text-sm font-medium"
            >42</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $89,320
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Outstanding</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Due within 30 days
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-purple-600 h-1 rounded-full" style="width: 45%"></div>
        </div>
      </div>

      <!-- Payables Due -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-xl flex items-center justify-center"
          >
            <i
              class="fas fa-clock text-orange-600 dark:text-orange-400 text-xl"
            ></i>
          </div>
          <span class="text-red-600 dark:text-red-400 text-sm font-medium"
            >15</span
          >
        </div>
        <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $34,580
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Payables Due</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Next 7 days
        </div>
        <div class="mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
          <div class="bg-orange-600 h-1 rounded-full" style="width: 25%"></div>
        </div>
      </div>
    </div>

    <!-- Additional KPI Row -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- Gross Margin -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-10 h-10 bg-indigo-100 dark:bg-indigo-900 rounded-lg flex items-center justify-center"
          >
            <i
              class="fas fa-percentage text-indigo-600 dark:text-indigo-400"
            ></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >+2.1%</span
          >
        </div>
        <div class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          64.0%
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Gross Margin</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Target: 62%
        </div>
      </div>

      <!-- Customer Acquisition Cost -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-10 h-10 bg-pink-100 dark:bg-pink-900 rounded-lg flex items-center justify-center"
          >
            <i class="fas fa-users text-pink-600 dark:text-pink-400"></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >-8.5%</span
          >
        </div>
        <div class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $1,240
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">CAC</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Per customer
        </div>
      </div>

      <!-- Monthly Recurring Revenue -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-10 h-10 bg-teal-100 dark:bg-teal-900 rounded-lg flex items-center justify-center"
          >
            <i class="fas fa-sync-alt text-teal-600 dark:text-teal-400"></i>
          </div>
          <span class="text-green-600 dark:text-green-400 text-sm font-medium"
            >+15.3%</span
          >
        </div>
        <div class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          $89,450
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">MRR</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Monthly recurring
        </div>
      </div>

      <!-- Employee Productivity -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-10 h-10 bg-cyan-100 dark:bg-cyan-900 rounded-lg flex items-center justify-center"
          >
            <i class="fas fa-user-clock text-cyan-600 dark:text-cyan-400"></i>
          </div>
          <span class="text-blue-600 dark:text-blue-400 text-sm font-medium"
            >+5.7%</span
          >
        </div>
        <div class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-1">
          87.3%
        </div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Productivity</div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-500">
          Utilization rate
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
      <!-- Income vs Expense Trend -->
      <div
        class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Income vs Expense Trend
            </h3>
            <div class="flex items-center space-x-2">
              <select
                class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
              >
                <option>Last 6 months</option>
                <option>Last year</option>
                <option>All time</option>
              </select>
              <button
                class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
              >
                <i class="fas fa-download text-sm"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="p-6">
          <canvas id="incomeExpenseChart" height="300"></canvas>
        </div>
      </div>

      <!-- Cash Flow & Profit Margin -->
      <div class="space-y-6">
        <!-- Cash Flow Curve -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Cash Flow
            </h4>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >Positive</span
            >
          </div>
          <canvas id="cashFlowChart" height="200"></canvas>
        </div>

        <!-- Profit Margin Ratio -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Profit Margin
            </h4>
            <span class="text-blue-600 dark:text-blue-400 text-sm font-medium"
              >64.0%</span
            >
          </div>
          <div
            class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
          >
            <div class="bg-blue-600 h-3 rounded-full" style="width: 64%"></div>
          </div>
          <div
            class="flex justify-between text-sm text-gray-600 dark:text-gray-400"
          >
            <span>Target: 60%</span>
            <span>+4% vs target</span>
          </div>
        </div>

        <!-- Budget vs Actual -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Budget vs Actual
            </h4>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >On Track</span
            >
          </div>
          <div class="space-y-3">
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Revenue</span
              >
              <div class="flex items-center space-x-2">
                <div class="w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div
                    class="bg-green-600 h-2 rounded-full"
                    style="width: 92%"
                  ></div>
                </div>
                <span
                  class="text-sm font-medium text-green-600 dark:text-green-400"
                  >92%</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Expenses</span
              >
              <div class="flex items-center space-x-2">
                <div class="w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div
                    class="bg-yellow-600 h-2 rounded-full"
                    style="width: 78%"
                  ></div>
                </div>
                <span
                  class="text-sm font-medium text-yellow-600 dark:text-yellow-400"
                  >78%</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Profit</span
              >
              <div class="flex items-center space-x-2">
                <div class="w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div
                    class="bg-blue-600 h-2 rounded-full"
                    style="width: 85%"
                  ></div>
                </div>
                <span
                  class="text-sm font-medium text-blue-600 dark:text-blue-400"
                  >85%</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- New Section: Recent Activities & Top Clients -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
      <!-- Recent Activities Feed -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Recent Activities
            </h3>
            <span class="text-sm text-gray-600 dark:text-gray-400"
              >Live Feed</span
            >
          </div>
        </div>
        <div class="p-6 space-y-4 max-h-96 overflow-y-auto">
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-plus text-green-600 dark:text-green-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                New invoice created
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                INV-2025-043 for $8,750 • 2 min ago
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-check text-blue-600 dark:text-blue-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                Payment received
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                $12,500 from ABC Corp • 15 min ago
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-clock text-orange-600 dark:text-orange-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                Expense approved
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                Office supplies - $2,340 • 1 hour ago
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-user-plus text-purple-600 dark:text-purple-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                New client onboarded
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                XYZ Industries • 2 hours ago
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                Invoice overdue
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                INV-2025-038 - 3 days past due • 3 hours ago
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <div
              class="w-8 h-8 bg-teal-100 dark:bg-teal-900 rounded-full flex items-center justify-center flex-shrink-0"
            >
              <i
                class="fas fa-sync text-teal-600 dark:text-teal-400 text-xs"
              ></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                Bank reconciliation completed
              </p>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                5 transactions matched • 4 hours ago
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Top Clients -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Top Clients
            </h3>
            <select
              class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
            >
              <option>This Month</option>
              <option>Last Month</option>
              <option>This Quarter</option>
            </select>
          </div>
        </div>
        <div class="p-6 space-y-4">
          <div
            class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"
          >
            <div class="flex items-center space-x-3">
              <div
                class="w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center"
              >
                <span class="text-sm font-bold text-blue-600 dark:text-blue-400"
                  >A</span
                >
              </div>
              <div>
                <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  ABC Corporation
                </p>
                <p class="text-xs text-gray-600 dark:text-gray-400">
                  15 invoices
                </p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-bold text-gray-900 dark:text-gray-100">
                $45,230
              </p>
              <p class="text-xs text-green-600 dark:text-green-400">+12%</p>
            </div>
          </div>
          <div
            class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"
          >
            <div class="flex items-center space-x-3">
              <div
                class="w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center"
              >
                <span
                  class="text-sm font-bold text-green-600 dark:text-green-400"
                  >T</span
                >
              </div>
              <div>
                <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  Tech Solutions Inc
                </p>
                <p class="text-xs text-gray-600 dark:text-gray-400">
                  8 invoices
                </p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-bold text-gray-900 dark:text-gray-100">
                $32,180
              </p>
              <p class="text-xs text-green-600 dark:text-green-400">+8%</p>
            </div>
          </div>
          <div
            class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"
          >
            <div class="flex items-center space-x-3">
              <div
                class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center"
              >
                <span
                  class="text-sm font-bold text-purple-600 dark:text-purple-400"
                  >G</span
                >
              </div>
              <div>
                <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  Global Services
                </p>
                <p class="text-xs text-gray-600 dark:text-gray-400">
                  12 invoices
                </p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-bold text-gray-900 dark:text-gray-100">
                $28,750
              </p>
              <p class="text-xs text-red-600 dark:text-red-400">-3%</p>
            </div>
          </div>
          <div
            class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"
          >
            <div class="flex items-center space-x-3">
              <div
                class="w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center"
              >
                <span
                  class="text-sm font-bold text-orange-600 dark:text-orange-400"
                  >M</span
                >
              </div>
              <div>
                <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  Media Group Ltd
                </p>
                <p class="text-xs text-gray-600 dark:text-gray-400">
                  6 invoices
                </p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-bold text-gray-900 dark:text-gray-100">
                $24,900
              </p>
              <p class="text-xs text-green-600 dark:text-green-400">+15%</p>
            </div>
          </div>
          <div
            class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"
          >
            <div class="flex items-center space-x-3">
              <div
                class="w-8 h-8 bg-pink-100 dark:bg-pink-900 rounded-full flex items-center justify-center"
              >
                <span class="text-sm font-bold text-pink-600 dark:text-pink-400"
                  >I</span
                >
              </div>
              <div>
                <p class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  Innovate Corp
                </p>
                <p class="text-xs text-gray-600 dark:text-gray-400">
                  9 invoices
                </p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-bold text-gray-900 dark:text-gray-100">
                $21,450
              </p>
              <p class="text-xs text-green-600 dark:text-green-400">+5%</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Financial Ratios & Performance -->
      <div class="space-y-6">
        <!-- Key Financial Ratios -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Financial Ratios
            </h4>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >Healthy</span
            >
          </div>
          <div class="space-y-4">
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Current Ratio</span
              >
              <div class="flex items-center space-x-2">
                <span
                  class="text-sm font-medium text-gray-900 dark:text-gray-100"
                  >2.4:1</span
                >
                <span class="text-xs text-green-600 dark:text-green-400"
                  >Good</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Quick Ratio</span
              >
              <div class="flex items-center space-x-2">
                <span
                  class="text-sm font-medium text-gray-900 dark:text-gray-100"
                  >1.8:1</span
                >
                <span class="text-xs text-green-600 dark:text-green-400"
                  >Good</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Debt-to-Equity</span
              >
              <div class="flex items-center space-x-2">
                <span
                  class="text-sm font-medium text-gray-900 dark:text-gray-100"
                  >0.3:1</span
                >
                <span class="text-xs text-green-600 dark:text-green-400"
                  >Low</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400">ROE</span>
              <div class="flex items-center space-x-2">
                <span
                  class="text-sm font-medium text-gray-900 dark:text-gray-100"
                  >18.5%</span
                >
                <span class="text-xs text-green-600 dark:text-green-400"
                  >Strong</span
                >
              </div>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400">ROA</span>
              <div class="flex items-center space-x-2">
                <span
                  class="text-sm font-medium text-gray-900 dark:text-gray-100"
                  >12.2%</span
                >
                <span class="text-xs text-blue-600 dark:text-blue-400"
                  >Good</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Upcoming Events -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Upcoming
            </h4>
            <span
              class="text-orange-600 dark:text-orange-400 text-sm font-medium"
              >5 events</span
            >
          </div>
          <div class="space-y-3">
            <div
              class="flex items-center space-x-3 p-2 bg-red-50 dark:bg-red-900 rounded-lg"
            >
              <i class="fas fa-calendar-alt text-red-500 text-sm"></i>
              <div class="flex-1">
                <p class="text-sm font-medium text-red-900 dark:text-red-100">
                  Tax Filing Deadline
                </p>
                <p class="text-xs text-red-700 dark:text-red-300">
                  Oct 15, 2025
                </p>
              </div>
            </div>
            <div
              class="flex items-center space-x-3 p-2 bg-blue-50 dark:bg-blue-900 rounded-lg"
            >
              <i class="fas fa-users text-blue-500 text-sm"></i>
              <div class="flex-1">
                <p class="text-sm font-medium text-blue-900 dark:text-blue-100">
                  Client Meeting
                </p>
                <p class="text-xs text-blue-700 dark:text-blue-300">
                  Oct 12, 2025
                </p>
              </div>
            </div>
            <div
              class="flex items-center space-x-3 p-2 bg-green-50 dark:bg-green-900 rounded-lg"
            >
              <i class="fas fa-university text-green-500 text-sm"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-green-900 dark:text-green-100"
                >
                  Bank Review
                </p>
                <p class="text-xs text-green-700 dark:text-green-300">
                  Oct 18, 2025
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- System Health -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
        >
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              System Health
            </h4>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >All Good</span
            >
          </div>
          <div class="space-y-3">
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >API Response</span
              >
              <span
                class="text-sm font-medium text-green-600 dark:text-green-400"
                >98ms</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Database</span
              >
              <span
                class="text-sm font-medium text-green-600 dark:text-green-400"
                >Healthy</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Backups</span
              >
              <span
                class="text-sm font-medium text-green-600 dark:text-green-400"
                >Current</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Security</span
              >
              <span
                class="text-sm font-medium text-green-600 dark:text-green-400"
                >Secure</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Middle Section: Transactions & Analytics -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
      <!-- Recent Transactions Table -->
      <div
        class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Recent Transactions
            </h3>
            <div class="flex items-center space-x-2">
              <button
                class="px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 font-medium"
              >
                View All
              </button>
              <button
                class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700"
              >
                + New
              </button>
            </div>
          </div>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-50 dark:bg-gray-700">
              <tr>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Date
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Description
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Category
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Amount
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                >
                  Status
                </th>
              </tr>
            </thead>
            <tbody
              class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
            >
              <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Oct 7, 2025
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Client Payment - ABC Corp
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                >
                  Revenue
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600 dark:text-green-400"
                >
                  +$12,500
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span
                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200"
                    >Completed</span
                  >
                </td>
              </tr>
              <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Oct 6, 2025
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Office Supplies Purchase
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                >
                  Expenses
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600 dark:text-red-400"
                >
                  -$2,340
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span
                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"
                    >Pending</span
                  >
                </td>
              </tr>
              <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Oct 5, 2025
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Software Subscription
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                >
                  Expenses
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600 dark:text-red-400"
                >
                  -$890
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span
                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200"
                    >Completed</span
                  >
                </td>
              </tr>
              <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Oct 4, 2025
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"
                >
                  Consulting Services
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                >
                  Revenue
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600 dark:text-green-400"
                >
                  +$8,750
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span
                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"
                    >Invoiced</span
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Right Sidebar: Notifications & Quick Actions -->
      <div class="space-y-6">
        <!-- Enhanced Notifications Panel -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
        >
          <div class="p-6 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
                Notifications
              </h3>
              <div class="flex items-center space-x-2">
                <span
                  class="bg-red-500 text-white text-xs px-2 py-1 rounded-full"
                  >7</span
                >
                <button
                  class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
                >
                  <i class="fas fa-cog text-sm"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="p-6 space-y-4 max-h-80 overflow-y-auto">
            <div
              class="flex items-start space-x-3 p-3 bg-red-50 dark:bg-red-900 rounded-lg border-l-4 border-red-500"
            >
              <i class="fas fa-exclamation-triangle text-red-500 mt-1"></i>
              <div class="flex-1">
                <p class="text-sm font-medium text-red-900 dark:text-red-100">
                  Critical: Tax Filing Due
                </p>
                <p class="text-xs text-red-700 dark:text-red-300">
                  VAT return due in 5 days. Auto-filing available.
                </p>
                <div class="mt-2 flex space-x-2">
                  <button
                    class="text-xs bg-red-600 text-white px-2 py-1 rounded"
                  >
                    File Now
                  </button>
                  <button class="text-xs text-red-700 dark:text-red-300">
                    Remind Later
                  </button>
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-yellow-50 dark:bg-yellow-900 rounded-lg border-l-4 border-yellow-500"
            >
              <i class="fas fa-clock text-yellow-500 mt-1"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-yellow-900 dark:text-yellow-100"
                >
                  Invoice Overdue
                </p>
                <p class="text-xs text-yellow-700 dark:text-yellow-300">
                  INV-2025-038 ($5,420) is 7 days overdue
                </p>
                <div class="mt-2 flex space-x-2">
                  <button
                    class="text-xs bg-yellow-600 text-white px-2 py-1 rounded"
                  >
                    Send Reminder
                  </button>
                  <button class="text-xs text-yellow-700 dark:text-yellow-300">
                    View Details
                  </button>
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg border-l-4 border-blue-500"
            >
              <i class="fas fa-info-circle text-blue-500 mt-1"></i>
              <div class="flex-1">
                <p class="text-sm font-medium text-blue-900 dark:text-blue-100">
                  Bank Reconciliation
                </p>
                <p class="text-xs text-blue-700 dark:text-blue-300">
                  5 transactions need review. 3 auto-matched.
                </p>
                <div class="mt-2 flex space-x-2">
                  <button
                    class="text-xs bg-blue-600 text-white px-2 py-1 rounded"
                  >
                    Review Now
                  </button>
                  <button class="text-xs text-blue-700 dark:text-blue-300">
                    Auto-Match
                  </button>
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-green-50 dark:bg-green-900 rounded-lg border-l-4 border-green-500"
            >
              <i class="fas fa-check-circle text-green-500 mt-1"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-green-900 dark:text-green-100"
                >
                  Payment Received
                </p>
                <p class="text-xs text-green-700 dark:text-green-300">
                  $12,500 from ABC Corp - Invoice settled
                </p>
                <div class="mt-2">
                  <span class="text-xs text-green-700 dark:text-green-300"
                    >Auto-reconciled • 2 hours ago</span
                  >
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-purple-50 dark:bg-purple-900 rounded-lg border-l-4 border-purple-500"
            >
              <i class="fas fa-robot text-purple-500 mt-1"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-purple-900 dark:text-purple-100"
                >
                  AI Insight Available
                </p>
                <p class="text-xs text-purple-700 dark:text-purple-300">
                  Cash flow optimization opportunity detected
                </p>
                <div class="mt-2 flex space-x-2">
                  <button
                    class="text-xs bg-purple-600 text-white px-2 py-1 rounded"
                  >
                    View Insight
                  </button>
                  <button class="text-xs text-purple-700 dark:text-purple-300">
                    Dismiss
                  </button>
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-indigo-50 dark:bg-indigo-900 rounded-lg border-l-4 border-indigo-500"
            >
              <i class="fas fa-chart-line text-indigo-500 mt-1"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-indigo-900 dark:text-indigo-100"
                >
                  Monthly Report Ready
                </p>
                <p class="text-xs text-indigo-700 dark:text-indigo-300">
                  September 2025 financial summary available
                </p>
                <div class="mt-2 flex space-x-2">
                  <button
                    class="text-xs bg-indigo-600 text-white px-2 py-1 rounded"
                  >
                    View Report
                  </button>
                  <button class="text-xs text-indigo-700 dark:text-indigo-300">
                    Download PDF
                  </button>
                </div>
              </div>
            </div>
            <div
              class="flex items-start space-x-3 p-3 bg-orange-50 dark:bg-orange-900 rounded-lg border-l-4 border-orange-500"
            >
              <i class="fas fa-user-plus text-orange-500 mt-1"></i>
              <div class="flex-1">
                <p
                  class="text-sm font-medium text-orange-900 dark:text-orange-100"
                >
                  New Client Onboarded
                </p>
                <p class="text-xs text-orange-700 dark:text-orange-300">
                  XYZ Industries - Welcome email sent
                </p>
                <div class="mt-2">
                  <span class="text-xs text-orange-700 dark:text-orange-300"
                    >Auto-setup completed • 4 hours ago</span
                  >
                </div>
              </div>
            </div>
          </div>
          <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <a
              href="#"
              class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium"
              >View All Notifications</a
            >
          </div>
        </div>

        <!-- Quick Actions -->
        <div
          class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
        >
          <div class="p-6 border-b border-gray-200 dark:border-gray-700">
            <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              Quick Actions
            </h3>
          </div>
          <div class="p-6 space-y-3">
            <a
              href="{% url 'create_invoice' %}"
              class="w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200"
            >
              <i class="fas fa-plus mr-2"></i>
              Create Invoice
            </a>
            <a
              href="{% url 'expense_management' %}"
              class="w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors duration-200"
            >
              <i class="fas fa-receipt mr-2"></i>
              Add Expense
            </a>
            <a
              href="{% url 'create_journal_entry' %}"
              class="w-full flex items-center justify-center px-4 py-3 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 transition-colors duration-200"
            >
              <i class="fas fa-journal-whills mr-2"></i>
              New Journal Entry
            </a>
            <a
              href="{% url 'bank_reconciliation' %}"
              class="w-full flex items-center justify-center px-4 py-3 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 transition-colors duration-200"
            >
              <i class="fas fa-university mr-2"></i>
              Reconcile Bank
            </a>
            <a
              href="{% url 'financial_statements' %}"
              class="w-full flex items-center justify-center px-4 py-3 bg-gray-600 dark:bg-gray-700 text-white font-medium rounded-lg hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors duration-200"
            >
              <i class="fas fa-chart-bar mr-2"></i>
              Generate Report
            </a>
          </div>
        </div>

        <!-- AI Insights -->
        <div
          class="bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900 dark:to-blue-900 rounded-2xl shadow-sm border border-purple-200 dark:border-purple-700"
        >
          <div class="p-6">
            <div class="flex items-center mb-4">
              <i
                class="fas fa-robot text-purple-600 dark:text-purple-400 text-xl mr-3"
              ></i>
              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
                AI Insights
              </h3>
            </div>
            <div class="space-y-3">
              <div class="p-3 bg-white dark:bg-gray-800 rounded-lg">
                <p class="text-sm text-gray-700 dark:text-gray-300">
                  💡 Expected cash inflow of $45K next week
                </p>
              </div>
              <div class="p-3 bg-white dark:bg-gray-800 rounded-lg">
                <p class="text-sm text-gray-700 dark:text-gray-300">
                  ⚠️ Office supplies expense 23% above budget
                </p>
              </div>
              <div class="p-3 bg-white dark:bg-gray-800 rounded-lg">
                <p class="text-sm text-gray-700 dark:text-gray-300">
                  📈 Revenue trend suggests 15% Q4 growth
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom Section: Analytics & Modules Overview -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
      <!-- Expense Breakdown Pie Chart -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Expense Breakdown
            </h3>
            <select
              class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
            >
              <option>This Month</option>
              <option>Last Month</option>
              <option>This Quarter</option>
            </select>
          </div>
        </div>
        <div class="p-6">
          <canvas id="expenseBreakdownChart" height="300"></canvas>
          <div class="mt-4 space-y-2">
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400"
                  >Office Supplies</span
                >
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$23,400 (26.3%)</span
              >
            </div>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400">Software</span>
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$18,200 (20.4%)</span
              >
            </div>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400">Marketing</span>
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$15,600 (17.5%)</span
              >
            </div>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400">Travel</span>
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$12,800 (14.3%)</span
              >
            </div>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400">Utilities</span>
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$9,800 (11.0%)</span
              >
            </div>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-gray-500 rounded-full"></div>
                <span class="text-gray-600 dark:text-gray-400">Other</span>
              </div>
              <span class="font-medium text-gray-900 dark:text-gray-100"
                >$9,620 (10.8%)</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Profit Trends -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Profit Trends
            </h3>
            <select
              class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
            >
              <option>Last 6 months</option>
              <option>Last year</option>
              <option>All time</option>
            </select>
          </div>
        </div>
        <div class="p-6">
          <canvas id="profitTrendsChart" height="300"></canvas>
        </div>
      </div>

      <!-- Goals & Targets -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Goals & Targets
            </h3>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >On Track</span
            >
          </div>
        </div>
        <div class="p-6 space-y-6">
          <!-- Monthly Revenue Goal -->
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-900 dark:text-gray-100"
                >Monthly Revenue</span
              >
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >$247K / $250K</span
              >
            </div>
            <div
              class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
            >
              <div
                class="bg-green-600 h-3 rounded-full"
                style="width: 98.8%"
              ></div>
            </div>
            <div
              class="flex justify-between text-xs text-gray-600 dark:text-gray-400"
            >
              <span>98.8% Complete</span>
              <span>$3K remaining</span>
            </div>
          </div>

          <!-- Client Acquisition -->
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-900 dark:text-gray-100"
                >New Clients</span
              >
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >5 / 8</span
              >
            </div>
            <div
              class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
            >
              <div
                class="bg-blue-600 h-3 rounded-full"
                style="width: 62.5%"
              ></div>
            </div>
            <div
              class="flex justify-between text-xs text-gray-600 dark:text-gray-400"
            >
              <span>62.5% Complete</span>
              <span>3 more needed</span>
            </div>
          </div>

          <!-- Expense Control -->
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-900 dark:text-gray-100"
                >Expense Budget</span
              >
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >$89K / $95K</span
              >
            </div>
            <div
              class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
            >
              <div
                class="bg-yellow-600 h-3 rounded-full"
                style="width: 93.7%"
              ></div>
            </div>
            <div
              class="flex justify-between text-xs text-gray-600 dark:text-gray-400"
            >
              <span>93.7% Used</span>
              <span>$6K remaining</span>
            </div>
          </div>

          <!-- Profit Margin -->
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-900 dark:text-gray-100"
                >Profit Margin</span
              >
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >64.0% / 65.0%</span
              >
            </div>
            <div
              class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
            >
              <div
                class="bg-purple-600 h-3 rounded-full"
                style="width: 98.5%"
              ></div>
            </div>
            <div
              class="flex justify-between text-xs text-gray-600 dark:text-gray-400"
            >
              <span>98.5% of Target</span>
              <span>1% to go</span>
            </div>
          </div>

          <!-- Quick Actions for Goals -->
          <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
            <div class="grid grid-cols-2 gap-2">
              <a
                href="{% url 'budgeting' %}"
                class="px-3 py-2 bg-blue-600 text-white text-xs font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 text-center"
              >
                Set New Goal
              </a>
              <a
                href="{% url 'budgeting' %}"
                class="px-3 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-xs font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200 text-center"
              >
                View All Goals
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Budgeting Module Section -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
      <!-- Budget Overview -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Budget Overview
            </h3>
            <span class="text-green-600 dark:text-green-400 text-sm font-medium"
              >On Track</span
            >
          </div>
        </div>
        <div class="p-6 space-y-4">
          <!-- Total Budget -->
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-900 dark:text-gray-100"
                >Total Budget</span
              >
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >$1.2M / $1.5M</span
              >
            </div>
            <div
              class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2"
            >
              <div
                class="bg-green-600 h-3 rounded-full"
                style="width: 80%"
              ></div>
            </div>
            <div
              class="flex justify-between text-xs text-gray-600 dark:text-gray-400"
            >
              <span>80% Utilized</span>
              <span>$300K remaining</span>
            </div>
          </div>

          <!-- Department Budgets -->
          <div class="space-y-3">
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Operations</span
              >
              <span
                class="text-sm font-medium text-green-600 dark:text-green-400"
                >$450K / $500K</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >Marketing</span
              >
              <span
                class="text-sm font-medium text-yellow-600 dark:text-yellow-400"
                >$180K / $200K</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-600 dark:text-gray-400">IT</span>
              <span class="text-sm font-medium text-blue-600 dark:text-blue-400"
                >$120K / $150K</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Budget Alerts -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
            Budget Alerts
          </h3>
        </div>
        <div class="p-6 space-y-4">
          <div
            class="flex items-start space-x-3 p-3 bg-yellow-50 dark:bg-yellow-900 rounded-lg border-l-4 border-yellow-500"
          >
            <i class="fas fa-exclamation-triangle text-yellow-500 mt-1"></i>
            <div class="flex-1">
              <p
                class="text-sm font-medium text-yellow-900 dark:text-yellow-100"
              >
                Marketing Budget Alert
              </p>
              <p class="text-xs text-yellow-700 dark:text-yellow-300">
                90% of quarterly budget used. 2 weeks remaining.
              </p>
              <div class="mt-2">
                <button
                  class="text-xs bg-yellow-600 text-white px-2 py-1 rounded"
                >
                  Review Budget
                </button>
              </div>
            </div>
          </div>
          <div
            class="flex items-start space-x-3 p-3 bg-red-50 dark:bg-red-900 rounded-lg border-l-4 border-red-500"
          >
            <i class="fas fa-times-circle text-red-500 mt-1"></i>
            <div class="flex-1">
              <p class="text-sm font-medium text-red-900 dark:text-red-100">
                Travel Expenses Over Budget
              </p>
              <p class="text-xs text-red-700 dark:text-red-300">
                $15K over allocated budget this month.
              </p>
              <div class="mt-2">
                <button class="text-xs bg-red-600 text-white px-2 py-1 rounded">
                  Adjust Budget
                </button>
              </div>
            </div>
          </div>
          <div
            class="flex items-start space-x-3 p-3 bg-green-50 dark:bg-green-900 rounded-lg border-l-4 border-green-500"
          >
            <i class="fas fa-check-circle text-green-500 mt-1"></i>
            <div class="flex-1">
              <p class="text-sm font-medium text-green-900 dark:text-green-100">
                IT Budget Under Control
              </p>
              <p class="text-xs text-green-700 dark:text-green-300">
                75% utilized with 3 months remaining.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Budget Forecast -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Budget Forecast
            </h3>
            <select
              class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
            >
              <option>Q4 2025</option>
              <option>Q1 2026</option>
              <option>2026 Full Year</option>
            </select>
          </div>
        </div>
        <div class="p-6">
          <canvas id="budgetForecastChart" height="200"></canvas>
          <div class="mt-4 grid grid-cols-2 gap-4 text-center">
            <div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Projected Variance
              </div>
              <div class="text-lg font-bold text-green-600 dark:text-green-400">
                +$45K
              </div>
            </div>
            <div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Confidence Level
              </div>
              <div class="text-lg font-bold text-blue-600 dark:text-blue-400">
                87%
              </div>
            </div>
          </div>
          <div class="mt-4 flex space-x-2">
            <a
              href="{% url 'budgeting' %}"
              class="flex-1 px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 text-center"
            >
              View Details
            </a>
            <button
              class="px-3 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200"
            >
              Export
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- New Section: Advanced Analytics -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <!-- Revenue by Client Type -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <a
              href="{% url 'financial_ratios' %}"
              class="text-xl font-bold text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200"
              >Revenue by Client Type</a
            >
            <select
              class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"
            >
              <option>This Quarter</option>
              <option>Last Quarter</option>
              <option>This Year</option>
            </select>
          </div>
        </div>
        <div class="p-6">
          <canvas id="revenueByClientChart" height="250"></canvas>
          <div class="mt-4 grid grid-cols-2 gap-4">
            <div class="text-center">
              <div class="text-lg font-bold text-blue-600 dark:text-blue-400">
                $145K
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Enterprise (58.5%)
              </div>
            </div>
            <div class="text-center">
              <div class="text-lg font-bold text-green-600 dark:text-green-400">
                $67K
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                SMB (27.0%)
              </div>
            </div>
            <div class="text-center">
              <div
                class="text-lg font-bold text-purple-600 dark:text-purple-400"
              >
                $35K
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Startup (14.1%)
              </div>
            </div>
            <div class="text-center">
              <div
                class="text-lg font-bold text-orange-600 dark:text-orange-400"
              >
                $580
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Other (0.2%)
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Cash Flow Forecast -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
      >
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
              Cash Flow Forecast
            </h3>
            <div class="flex items-center space-x-2">
              <span
                class="text-green-600 dark:text-green-400 text-sm font-medium"
                >Positive Trend</span
              >
              <button
                class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
              >
                <i class="fas fa-info-circle text-sm"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="p-6">
          <canvas id="cashFlowForecastChart" height="250"></canvas>
          <div class="mt-4 grid grid-cols-3 gap-4 text-center">
            <div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Next Week
              </div>
              <div class="text-lg font-bold text-green-600 dark:text-green-400">
                +$45K
              </div>
            </div>
            <div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Next Month
              </div>
              <div class="text-lg font-bold text-blue-600 dark:text-blue-400">
                +$127K
              </div>
            </div>
            <div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                Q4 Total
              </div>
              <div
                class="text-lg font-bold text-purple-600 dark:text-purple-400"
              >
                +$389K
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Module Overview Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8">
      <!-- General Ledger -->
      <a
        href="{% url 'general_ledger' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center group-hover:bg-blue-200 dark:group-hover:bg-blue-800 transition-colors duration-200"
          >
            <i class="fas fa-book text-blue-600 dark:text-blue-400 text-xl"></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          General Ledger
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          Chart of accounts, journals, and ledger balances
        </p>
        <div
          class="flex items-center text-sm text-blue-600 dark:text-blue-400 font-medium"
        >
          <span>Access Module</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>

      <!-- Invoices & Billing -->
      <a
        href="{% url 'invoices' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center group-hover:bg-green-200 dark:group-hover:bg-green-800 transition-colors duration-200"
          >
            <i
              class="fas fa-file-invoice-dollar text-green-600 dark:text-green-400 text-xl"
            ></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          Invoices & Billing
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          Create, send, and track invoices
        </p>
        <div
          class="flex items-center text-sm text-green-600 dark:text-green-400 font-medium"
        >
          <span>42 pending</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>

      <!-- Cash Management -->
      <a
        href="{% url 'bank_reconciliation' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-yellow-100 dark:bg-yellow-900 rounded-xl flex items-center justify-center group-hover:bg-yellow-200 dark:group-hover:bg-yellow-800 transition-colors duration-200"
          >
            <i
              class="fas fa-cash-register text-yellow-600 dark:text-yellow-400 text-xl"
            ></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          Cash Management
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          Bank reconciliation and cash flow
        </p>
        <div
          class="flex items-center text-sm text-yellow-600 dark:text-yellow-400 font-medium"
        >
          <span>$423K available</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>

      <!-- Tax & Compliance -->
      <a
        href="{% url 'tax_center' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center group-hover:bg-purple-200 dark:group-hover:bg-purple-800 transition-colors duration-200"
          >
            <i
              class="fas fa-gavel text-purple-600 dark:text-purple-400 text-xl"
            ></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          Tax & Compliance
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          VAT, tax reports, and filings
        </p>
        <div
          class="flex items-center text-sm text-purple-600 dark:text-purple-400 font-medium"
        >
          <span>Due in 5 days</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>

      <!-- Fixed Assets -->
      <a
        href="{% url 'fixed_assets' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-indigo-100 dark:bg-indigo-900 rounded-xl flex items-center justify-center group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800 transition-colors duration-200"
          >
            <i
              class="fas fa-building text-indigo-600 dark:text-indigo-400 text-xl"
            ></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          Fixed Assets
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          Asset tracking and depreciation
        </p>
        <div
          class="flex items-center text-sm text-indigo-600 dark:text-indigo-400 font-medium"
        >
          <span>$2.4M total value</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>

      <!-- Inventory -->
      <a
        href="{% url 'inventory' %}"
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200 group cursor-pointer block"
      >
        <div class="flex items-center justify-between mb-4">
          <div
            class="w-12 h-12 bg-teal-100 dark:bg-teal-900 rounded-xl flex items-center justify-center group-hover:bg-teal-200 dark:group-hover:bg-teal-800 transition-colors duration-200"
          >
            <i
              class="fas fa-boxes text-teal-600 dark:text-teal-400 text-xl"
            ></i>
          </div>
          <i
            class="fas fa-arrow-right text-gray-400 dark:text-gray-500 group-hover:text-teal-600 dark:group-hover:text-teal-400 transition-colors duration-200"
          ></i>
        </div>
        <h4 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
          Inventory
        </h4>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
          Stock management and tracking
        </p>
        <div
          class="flex items-center text-sm text-teal-600 dark:text-teal-400 font-medium"
        >
          <span>1,247 items</span>
          <i class="fas fa-external-link-alt ml-1"></i>
        </div>
      </a>
    </div>

    <!-- Footer Stats -->
    <div
      class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"
    >
      <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-900 dark:text-gray-100">
            1,247
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
            Total Transactions
          </div>
          <div class="text-xs text-green-600 dark:text-green-400 mt-1">
            +23 this month
          </div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-900 dark:text-gray-100">
            89
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
            Active Clients
          </div>
          <div class="text-xs text-blue-600 dark:text-blue-400 mt-1">
            +5 this month
          </div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-900 dark:text-gray-100">
            156
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
            Journal Entries
          </div>
          <div class="text-xs text-purple-600 dark:text-purple-400 mt-1">
            +12 this month
          </div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-900 dark:text-gray-100">
            98.5%
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
            System Uptime
          </div>
          <div class="text-xs text-green-600 dark:text-green-400 mt-1">
            Last 30 days
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Theme Toggle and Tab Functionality -->
<script>
  // Theme toggle
  const themeToggle = document.getElementById("theme-toggle");
  themeToggle.addEventListener("click", () => {
    const html = document.documentElement;
    const isDark = html.classList.contains("dark");
    if (isDark) {
      html.classList.remove("dark");
      localStorage.setItem("theme", "light");
    } else {
      html.classList.add("dark");
      localStorage.setItem("theme", "dark");
    }
  });

  // Help dropdown
  const helpBtn = document.getElementById("help-btn");
  const helpDropdown = document.getElementById("help-dropdown");

  helpBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    const isHidden = helpDropdown.classList.contains("hidden");

    // Close other dropdowns
    quickActionMenu.classList.add("hidden");
    notificationsDropdown.classList.add("hidden");

    if (isHidden) {
      helpDropdown.classList.remove("hidden");
    } else {
      helpDropdown.classList.add("hidden");
    }
  });

  // Close help dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!helpDropdown.contains(e.target) && !helpBtn.contains(e.target)) {
      helpDropdown.classList.add("hidden");
    }
  });

  // Notifications functionality
  const notificationsBtn = document.getElementById("notifications-btn");
  const notificationsDropdown = document.getElementById(
    "notifications-dropdown"
  );
  const notificationCount = document.getElementById("notification-count");
  const notificationsList = document.getElementById("notifications-list");
  const markAllReadBtn = document.getElementById("mark-all-read-btn");
  const refreshNotificationsBtn = document.getElementById(
    "refresh-notifications-btn"
  );

  let notificationsData = [];

  // Toggle notifications dropdown
  notificationsBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    const isHidden = notificationsDropdown.classList.contains("hidden");

    // Close other dropdowns
    quickActionMenu.classList.add("hidden");

    if (isHidden) {
      notificationsDropdown.classList.remove("hidden");
      loadNotifications();
    } else {
      notificationsDropdown.classList.add("hidden");
    }
  });

  // Close notifications dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (
      !notificationsDropdown.contains(e.target) &&
      !notificationsBtn.contains(e.target)
    ) {
      notificationsDropdown.classList.add("hidden");
    }
  });

  // Load notifications from API
  async function loadNotifications() {
    try {
      const response = await fetch("/api/notifications/");
      const data = await response.json();

      if (data.success) {
        notificationsData = data.notifications;
        updateNotificationCount(data.notifications);
        renderNotifications(data.notifications);
      } else {
        showNotificationError("Failed to load notifications");
      }
    } catch (error) {
      console.error("Error loading notifications:", error);
      showNotificationError("Error loading notifications");
    }
  }

  // Update notification count badge
  function updateNotificationCount(notifications) {
    const unreadCount = notifications.filter((n) => !n.is_read).length;
    if (unreadCount > 0) {
      notificationCount.textContent = unreadCount > 99 ? "99+" : unreadCount;
      notificationCount.classList.remove("hidden");
    } else {
      notificationCount.classList.add("hidden");
    }
  }

  // Render notifications in dropdown
  function renderNotifications(notifications) {
    if (notifications.length === 0) {
      notificationsList.innerHTML = `
                <div class="p-4 text-center text-gray-500 dark:text-gray-400">
                    <i class="fas fa-bell-slash text-3xl mb-2"></i>
                    <p>No notifications yet</p>
                </div>
            `;
      return;
    }

    const notificationsHtml = notifications
      .slice(0, 10)
      .map((notification) => {
        const typeClasses = getNotificationTypeClasses(
          notification.notification_type
        );
        const timeAgo = getTimeAgo(notification.created_at);

        return `
                <div class="p-4 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer notification-item" data-id="${
                  notification.id
                }" data-read="${notification.is_read}">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 ${
                              typeClasses.bg
                            } rounded-full flex items-center justify-center">
                                <i class="fas ${typeClasses.icon} text-sm ${
          typeClasses.text
        }"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-gray-900 dark:text-gray-100 ${
                              !notification.is_read ? "font-semibold" : ""
                            }">${notification.title}</p>
                            <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${
                              notification.message
                            }</p>
                            <div class="flex items-center justify-between mt-2">
                                <span class="text-xs text-gray-500 dark:text-gray-500">${timeAgo}</span>
                                ${
                                  notification.action_text
                                    ? `<button class="text-xs ${typeClasses.button} hover:opacity-80 notification-action" data-url="${notification.action_url}">${notification.action_text}</button>`
                                    : ""
                                }
                            </div>
                        </div>
                        ${
                          !notification.is_read
                            ? '<div class="w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"></div>'
                            : ""
                        }
                    </div>
                </div>
            `;
      })
      .join("");

    notificationsList.innerHTML = notificationsHtml;

    // Add event listeners to notification items
    document.querySelectorAll(".notification-item").forEach((item) => {
      item.addEventListener("click", (e) => {
        if (!e.target.classList.contains("notification-action")) {
          const notificationId = item.dataset.id;
          markNotificationAsRead(notificationId);
        }
      });
    });

    // Add event listeners to action buttons
    document.querySelectorAll(".notification-action").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const url = btn.dataset.url;
        if (url) {
          window.location.href = url;
        }
      });
    });
  }

  // Mark notification as read
  async function markNotificationAsRead(notificationId) {
    try {
      const response = await fetch("/api/notifications/mark-read/", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-CSRFToken": getCSRFToken(),
        },
        body: JSON.stringify({ notification_id: notificationId }),
      });

      const data = await response.json();
      if (data.success) {
        // Update local data
        const notification = notificationsData.find(
          (n) => n.id == notificationId
        );
        if (notification) {
          notification.is_read = true;
        }
        updateNotificationCount(notificationsData);
        loadNotifications(); // Refresh the list
      }
    } catch (error) {
      console.error("Error marking notification as read:", error);
    }
  }

  // Mark all notifications as read
  markAllReadBtn.addEventListener("click", async () => {
    try {
      const response = await fetch("/api/notifications/mark-all-read/", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-CSRFToken": getCSRFToken(),
        },
      });

      const data = await response.json();
      if (data.success) {
        // Update all notifications as read
        notificationsData.forEach((n) => (n.is_read = true));
        updateNotificationCount(notificationsData);
        loadNotifications(); // Refresh the list
      }
    } catch (error) {
      console.error("Error marking all notifications as read:", error);
    }
  });

  // Refresh notifications
  refreshNotificationsBtn.addEventListener("click", () => {
    loadNotifications();
  });

  // Get notification type classes
  function getNotificationTypeClasses(type) {
    const types = {
      info: {
        bg: "bg-blue-100 dark:bg-blue-900",
        text: "text-blue-600 dark:text-blue-400",
        icon: "fa-info-circle",
        button: "text-blue-600 dark:text-blue-400",
      },
      success: {
        bg: "bg-green-100 dark:bg-green-900",
        text: "text-green-600 dark:text-green-400",
        icon: "fa-check-circle",
        button: "text-green-600 dark:text-green-400",
      },
      warning: {
        bg: "bg-yellow-100 dark:bg-yellow-900",
        text: "text-yellow-600 dark:text-yellow-400",
        icon: "fa-exclamation-triangle",
        button: "text-yellow-600 dark:text-yellow-400",
      },
      error: {
        bg: "bg-red-100 dark:bg-red-900",
        text: "text-red-600 dark:text-red-400",
        icon: "fa-exclamation-circle",
        button: "text-red-600 dark:text-red-400",
      },
    };
    return types[type] || types["info"];
  }

  // Get time ago string
  function getTimeAgo(dateString) {
    const now = new Date();
    const date = new Date(dateString);
    const diffInSeconds = Math.floor((now - date) / 1000);

    if (diffInSeconds < 60) return "Just now";
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
    if (diffInSeconds < 86400)
      return `${Math.floor(diffInSeconds / 3600)}h ago`;
    return `${Math.floor(diffInSeconds / 86400)}d ago`;
  }

  // Show notification error
  function showNotificationError(message) {
    notificationsList.innerHTML = `
            <div class="p-4 text-center text-red-500 dark:text-red-400">
                <i class="fas fa-exclamation-triangle text-3xl mb-2"></i>
                <p>${message}</p>
            </div>
        `;
  }

  // Get CSRF token
  function getCSRFToken() {
    const csrfToken = document.querySelector("[name=csrfmiddlewaretoken]");
    return csrfToken ? csrfToken.value : "";
  }

  // Load notifications on page load
  document.addEventListener("DOMContentLoaded", () => {
    loadNotifications();
  });

  // Tab functionality (basic, since content is static)
  const tabButtons = document.querySelectorAll(".tab-button");
  tabButtons.forEach((button) => {
    button.addEventListener("click", () => {
      tabButtons.forEach((btn) => btn.classList.remove("active"));
      button.classList.add("active");
      // In a real app, you'd show/hide content based on tab
    });
  });
</script>

<!-- Chart.js Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Income vs Expense Trend Chart
  const incomeExpenseCtx = document
    .getElementById("incomeExpenseChart")
    .getContext("2d");
  new Chart(incomeExpenseCtx, {
    type: "line",
    data: {
      labels: [
        "Jan",
        "Feb",
        "Mar",
        "Apr",
        "May",
        "Jun",
        "Jul",
        "Aug",
        "Sep",
        "Oct",
      ],
      datasets: [
        {
          label: "Revenue",
          data: [
            180000, 195000, 210000, 225000, 235000, 240000, 245000, 250000,
            255000, 247580,
          ],
          borderColor: "#10B981",
          backgroundColor: "rgba(16, 185, 129, 0.1)",
          tension: 0.4,
          fill: true,
        },
        {
          label: "Expenses",
          data: [
            95000, 98000, 102000, 105000, 108000, 112000, 115000, 118000,
            121000, 89420,
          ],
          borderColor: "#EF4444",
          backgroundColor: "rgba(239, 68, 68, 0.1)",
          tension: 0.4,
          fill: true,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "top",
        },
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            callback: function (value) {
              return "$" + value / 1000 + "K";
            },
          },
        },
      },
    },
  });

  // Cash Flow Chart
  const cashFlowCtx = document.getElementById("cashFlowChart").getContext("2d");
  new Chart(cashFlowCtx, {
    type: "line",
    data: {
      labels: ["Week 1", "Week 2", "Week 3", "Week 4"],
      datasets: [
        {
          label: "Cash Flow",
          data: [380000, 395000, 410000, 423750],
          borderColor: "#3B82F6",
          backgroundColor: "rgba(59, 130, 246, 0.1)",
          tension: 0.4,
          fill: true,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: false,
        },
      },
      scales: {
        y: {
          beginAtZero: false,
          ticks: {
            callback: function (value) {
              return "$" + value / 1000 + "K";
            },
          },
        },
      },
    },
  });

  // Expense Breakdown Pie Chart
  const expenseBreakdownCtx = document
    .getElementById("expenseBreakdownChart")
    .getContext("2d");
  new Chart(expenseBreakdownCtx, {
    type: "doughnut",
    data: {
      labels: [
        "Office Supplies",
        "Software",
        "Marketing",
        "Travel",
        "Utilities",
        "Other",
      ],
      datasets: [
        {
          data: [23400, 18200, 15600, 12800, 9800, 9620],
          backgroundColor: [
            "#EF4444",
            "#F59E0B",
            "#10B981",
            "#3B82F6",
            "#8B5CF6",
            "#6B7280",
          ],
          borderWidth: 0,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "bottom",
          labels: {
            padding: 20,
            usePointStyle: true,
          },
        },
      },
    },
  });

  // Profit Trends Chart
  const profitTrendsCtx = document
    .getElementById("profitTrendsChart")
    .getContext("2d");
  new Chart(profitTrendsCtx, {
    type: "line",
    data: {
      labels: [
        "Jan",
        "Feb",
        "Mar",
        "Apr",
        "May",
        "Jun",
        "Jul",
        "Aug",
        "Sep",
        "Oct",
      ],
      datasets: [
        {
          label: "Net Profit",
          data: [
            120000, 135000, 150000, 165000, 175000, 180000, 185000, 190000,
            195000, 158160,
          ],
          borderColor: "#10B981",
          backgroundColor: "rgba(16, 185, 129, 0.1)",
          tension: 0.4,
          fill: true,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "top",
        },
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            callback: function (value) {
              return "$" + value / 1000 + "K";
            },
          },
        },
      },
    },
  });

  // Revenue by Client Type Chart
  const revenueByClientCtx = document
    .getElementById("revenueByClientChart")
    .getContext("2d");
  new Chart(revenueByClientCtx, {
    type: "doughnut",
    data: {
      labels: ["Enterprise", "SMB", "Startup", "Other"],
      datasets: [
        {
          data: [145000, 67000, 35000, 580],
          backgroundColor: ["#3B82F6", "#10B981", "#8B5CF6", "#F59E0B"],
          borderWidth: 0,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "bottom",
          labels: {
            padding: 20,
            usePointStyle: true,
          },
        },
      },
    },
  });

  // Cash Flow Forecast Chart
  const cashFlowForecastCtx = document
    .getElementById("cashFlowForecastChart")
    .getContext("2d");
  new Chart(cashFlowForecastCtx, {
    type: "line",
    data: {
      labels: ["Oct", "Nov", "Dec", "Jan", "Feb", "Mar"],
      datasets: [
        {
          label: "Projected Cash Flow",
          data: [423750, 468750, 495750, 522750, 549750, 576750],
          borderColor: "#10B981",
          backgroundColor: "rgba(16, 185, 129, 0.1)",
          tension: 0.4,
          fill: true,
        },
        {
          label: "Conservative Estimate",
          data: [423750, 445750, 467750, 489750, 511750, 533750],
          borderColor: "#F59E0B",
          backgroundColor: "rgba(245, 158, 11, 0.1)",
          tension: 0.4,
          fill: true,
          borderDash: [5, 5],
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "top",
        },
      },
      scales: {
        y: {
          beginAtZero: false,
          ticks: {
            callback: function (value) {
              return "$" + value / 1000 + "K";
            },
          },
        },
      },
    },
  });

  // Budget Forecast Chart
  const budgetForecastCtx = document
    .getElementById("budgetForecastChart")
    .getContext("2d");
  new Chart(budgetForecastCtx, {
    type: "line",
    data: {
      labels: ["Q4 2025", "Q1 2026", "Q2 2026", "Q3 2026", "Q4 2026"],
      datasets: [
        {
          label: "Budget Allocation",
          data: [1200000, 1350000, 1420000, 1480000, 1550000],
          borderColor: "#3B82F6",
          backgroundColor: "rgba(59, 130, 246, 0.1)",
          tension: 0.4,
          fill: true,
        },
        {
          label: "Actual Spending",
          data: [960000, 1080000, 1140000, null, null],
          borderColor: "#EF4444",
          backgroundColor: "rgba(239, 68, 68, 0.1)",
          tension: 0.4,
          fill: true,
          borderDash: [5, 5],
        },
        {
          label: "Projected Spending",
          data: [960000, 1080000, 1140000, 1250000, 1380000],
          borderColor: "#F59E0B",
          backgroundColor: "rgba(245, 158, 11, 0.1)",
          tension: 0.4,
          fill: true,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "top",
        },
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            callback: function (value) {
              return "$" + value / 1000 + "K";
            },
          },
        },
      },
    },
  });
</script>
{% block footer %}{% endblock %} {% endblock %}
